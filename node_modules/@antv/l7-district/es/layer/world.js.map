{"version":3,"sources":["../../src/layer/world.ts"],"names":["LineLayer","getDataConfig","BaseLayer","WorldLayer","scene","option","loadData","then","fillData","lineData","fillLabel","addFillLayer","options","showBorder","addFillLine","label","enable","addLabelLayer","data","bord1","features","filter","feature","properties","type","bordFc","nationalBorder","nationalFc","addNationBorder","countryConfig","geoDataLevel","world","fetchData","fill","line","map","center","x","y","boundaries","boundaries2","nationalStroke","nationalWidth","coastlineStroke","chinaNationalStroke","chinaNationalWidth","coastlineWidth","visible","zIndex","lineLayer","source","size","v","color","lineLayer2","shape","style","lineType","dashArray","addLayer","layers","push"],"mappings":"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","sourcesContent":["import {\n  ILayer,\n  LineLayer,\n  PointLayer,\n  PolygonLayer,\n  Scene,\n  StyleAttrField,\n} from '@antv/l7';\nimport { getDataConfig } from '../';\nimport BaseLayer from './baseLayer';\nimport { IDistrictLayerOption } from './interface';\nexport default class WorldLayer extends BaseLayer {\n  constructor(scene: Scene, option: Partial<IDistrictLayerOption> = {}) {\n    super(scene, option);\n    this.loadData().then(([fillData, lineData, fillLabel]) => {\n      this.addFillLayer(fillData);\n      if (this.options.showBorder) {\n        this.addFillLine(lineData);\n      }\n      if (this.options.label?.enable) {\n        this.addLabelLayer(fillLabel, 'json');\n      }\n    });\n  }\n\n  public addFillLine(data: any) {\n    // 未定国界\n    const bord1 = data.features.filter((feature: any) => {\n      return (\n        feature.properties.type === '10' ||\n        feature.properties.type === '1' ||\n        feature.properties.type === '11' ||\n        feature.properties.type === '8'\n      );\n    });\n    const bordFc = {\n      type: 'FeatureCollection',\n      features: bord1,\n    };\n    // 已确定国界\n    const nationalBorder = data.features.filter((feature: any) => {\n      return (\n        feature.properties.type !== '10' &&\n        feature.properties.type !== '1' &&\n        feature.properties.type !== '11' &&\n        feature.properties.type !== '8'\n      );\n    });\n    const nationalFc = {\n      type: 'FeatureCollection',\n      features: nationalBorder,\n    };\n    this.addNationBorder(nationalFc, bordFc);\n  }\n\n  private async loadData() {\n    const countryConfig = getDataConfig(this.options.geoDataLevel).world;\n\n    const fillData = await this.fetchData(countryConfig.fill);\n    const lineData = await this.fetchData(countryConfig.line);\n    // const fillLabel = await this.fetchData(countryConfig.label);\n    const fillLabel = fillData.features.map((feature: any) => {\n      return {\n        ...feature.properties,\n        center: [feature.properties.x, feature.properties.y],\n      };\n    });\n    return [fillData, lineData, fillLabel];\n  }\n  private addNationBorder(boundaries: any, boundaries2: any) {\n    const {\n      nationalStroke,\n      nationalWidth,\n      coastlineStroke,\n      chinaNationalStroke,\n      chinaNationalWidth,\n      coastlineWidth,\n      visible,\n      zIndex,\n    } = this.options;\n    // 添加国界线\n    const lineLayer = new LineLayer({\n      zIndex: zIndex + 0.1,\n      visible,\n    })\n      .source(boundaries)\n      // .size(0.6)\n      .size('type', (v: string) => {\n        if (v === '0') {\n          return chinaNationalWidth; // 中国国界线\n        } else if (v === '2' || v === '9') {\n          return coastlineWidth; // 中国海岸线\n        } else if (v === '7') {\n          return nationalWidth; // 国外国界\n        } else {\n          return nationalWidth;\n        }\n      })\n      .color('type', (v: string) => {\n        if (v === '0') {\n          return chinaNationalStroke; // 中国国界线\n        } else if (v === '2' || v === '9') {\n          return coastlineStroke; // 中国海岸线\n        } else if (v === '7') {\n          return nationalStroke; // 国外国界\n        } else {\n          return nationalStroke;\n        }\n      });\n    // 添加未定国界\n    const lineLayer2 = new LineLayer({\n      zIndex: zIndex + 0.1,\n      visible,\n    })\n      .source(boundaries2)\n      .size('type', (v: string) => {\n        if (v === '1') {\n          return chinaNationalWidth;\n        } else {\n          return nationalWidth;\n        }\n      })\n      .shape('line')\n      .color('type', (v: string) => {\n        if (v === '1') {\n          return chinaNationalStroke;\n        } else {\n          return nationalStroke;\n        }\n      })\n      .style({\n        lineType: 'dash',\n        dashArray: [2, 2],\n      });\n\n    this.scene.addLayer(lineLayer);\n    this.scene.addLayer(lineLayer2);\n\n    this.layers.push(lineLayer, lineLayer2);\n  }\n}\n"],"file":"world.js"}