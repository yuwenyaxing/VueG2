!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@antv/l7")):"function"==typeof define&&define.amd?define(["exports","@antv/l7"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).L7=t.L7||{},t.L7.District={}),t.L7)}(this,(function(t,e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function i(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var n=function(){return(n=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function o(t,e,r,i){return new(r||(r=Promise))((function(n,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((i=i.apply(t,e||[])).next())}))}function a(t,e){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var s=function(){this.__data__=[],this.size=0};var u=function(t,e){return t===e||t!=t&&e!=e};var c=function(t,e){for(var r=t.length;r--;)if(u(t[r][0],e))return r;return-1},l=Array.prototype.splice;var p=function(t){var e=this.__data__,r=c(e,t);return!(r<0)&&(r==e.length-1?e.pop():l.call(e,r,1),--this.size,!0)};var f=function(t){var e=this.__data__,r=c(e,t);return r<0?void 0:e[r][1]};var h=function(t){return c(this.__data__,t)>-1};var d=function(t,e){var r=this.__data__,i=c(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this};function y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}y.prototype.clear=s,y.prototype.delete=p,y.prototype.get=f,y.prototype.has=h,y.prototype.set=d;var b=y;var v=function(){this.__data__=new b,this.size=0};var w=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var g=function(t){return this.__data__.get(t)};var L=function(t){return this.__data__.has(t)},m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _(t,e){return t(e={exports:{}},e.exports),e.exports}var j="object"==typeof m&&m&&m.Object===Object&&m,x="object"==typeof self&&self&&self.Object===Object&&self,F=j||x||Function("return this")(),D=F.Symbol,S=Object.prototype,O=S.hasOwnProperty,P=S.toString,k=D?D.toStringTag:void 0;var M=function(t){var e=O.call(t,k),r=t[k];try{t[k]=void 0;var i=!0}catch(t){}var n=P.call(t);return i&&(e?t[k]=r:delete t[k]),n},V=Object.prototype.toString;var B=function(t){return V.call(t)},A=D?D.toStringTag:void 0;var C=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":A&&A in Object(t)?M(t):B(t)};var z=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var T,E=function(t){if(!z(t))return!1;var e=C(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},N=F["__core-js_shared__"],I=(T=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"";var W=function(t){return!!I&&I in t},H=Function.prototype.toString;var U=function(t){if(null!=t){try{return H.call(t)}catch(t){}try{return t+""}catch(t){}}return""},R=/^\[object .+?Constructor\]$/,G=Function.prototype,$=Object.prototype,q=G.toString,Z=$.hasOwnProperty,J=RegExp("^"+q.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var K=function(t){return!(!z(t)||W(t))&&(E(t)?J:R).test(U(t))};var Q=function(t,e){return null==t?void 0:t[e]};var X=function(t,e){var r=Q(t,e);return K(r)?r:void 0},Y=X(F,"Map"),tt=X(Object,"create");var et=function(){this.__data__=tt?tt(null):{},this.size=0};var rt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},it=Object.prototype.hasOwnProperty;var nt=function(t){var e=this.__data__;if(tt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return it.call(e,t)?e[t]:void 0},ot=Object.prototype.hasOwnProperty;var at=function(t){var e=this.__data__;return tt?void 0!==e[t]:ot.call(e,t)};var st=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=tt&&void 0===e?"__lodash_hash_undefined__":e,this};function ut(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}ut.prototype.clear=et,ut.prototype.delete=rt,ut.prototype.get=nt,ut.prototype.has=at,ut.prototype.set=st;var ct=ut;var lt=function(){this.size=0,this.__data__={hash:new ct,map:new(Y||b),string:new ct}};var pt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var ft=function(t,e){var r=t.__data__;return pt(e)?r["string"==typeof e?"string":"hash"]:r.map};var ht=function(t){var e=ft(this,t).delete(t);return this.size-=e?1:0,e};var dt=function(t){return ft(this,t).get(t)};var yt=function(t){return ft(this,t).has(t)};var bt=function(t,e){var r=ft(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this};function vt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}vt.prototype.clear=lt,vt.prototype.delete=ht,vt.prototype.get=dt,vt.prototype.has=yt,vt.prototype.set=bt;var wt=vt;var gt=function(t,e){var r=this.__data__;if(r instanceof b){var i=r.__data__;if(!Y||i.length<199)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new wt(i)}return r.set(t,e),this.size=r.size,this};function Lt(t){var e=this.__data__=new b(t);this.size=e.size}Lt.prototype.clear=v,Lt.prototype.delete=w,Lt.prototype.get=g,Lt.prototype.has=L,Lt.prototype.set=gt;var mt=Lt,_t=function(){try{var t=X(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var jt=function(t,e,r){"__proto__"==e&&_t?_t(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r};var xt=function(t,e,r){(void 0!==r&&!u(t[e],r)||void 0===r&&!(e in t))&&jt(t,e,r)};var Ft=function(t){return function(e,r,i){for(var n=-1,o=Object(e),a=i(e),s=a.length;s--;){var u=a[t?s:++n];if(!1===r(o[u],u,o))break}return e}}(),Dt=_((function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r?F.Buffer:void 0,o=n?n.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,i=o?o(r):new t.constructor(r);return t.copy(i),i}})),St=F.Uint8Array;var Ot=function(t){var e=new t.constructor(t.byteLength);return new St(e).set(new St(t)),e};var Pt=function(t,e){var r=e?Ot(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var kt=function(t,e){var r=-1,i=t.length;for(e||(e=Array(i));++r<i;)e[r]=t[r];return e},Mt=Object.create,Vt=function(){function t(){}return function(e){if(!z(e))return{};if(Mt)return Mt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var Bt=function(t,e){return function(r){return t(e(r))}}(Object.getPrototypeOf,Object),At=Object.prototype;var Ct=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||At)};var zt=function(t){return"function"!=typeof t.constructor||Ct(t)?{}:Vt(Bt(t))};var Tt=function(t){return null!=t&&"object"==typeof t};var Et=function(t){return Tt(t)&&"[object Arguments]"==C(t)},Nt=Object.prototype,It=Nt.hasOwnProperty,Wt=Nt.propertyIsEnumerable,Ht=Et(function(){return arguments}())?Et:function(t){return Tt(t)&&It.call(t,"callee")&&!Wt.call(t,"callee")},Ut=Array.isArray;var Rt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var Gt=function(t){return null!=t&&Rt(t.length)&&!E(t)};var $t=function(t){return Tt(t)&&Gt(t)};var qt=function(){return!1},Zt=_((function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r?F.Buffer:void 0,o=(n?n.isBuffer:void 0)||qt;t.exports=o})),Jt=Function.prototype,Kt=Object.prototype,Qt=Jt.toString,Xt=Kt.hasOwnProperty,Yt=Qt.call(Object);var te=function(t){if(!Tt(t)||"[object Object]"!=C(t))return!1;var e=Bt(t);if(null===e)return!0;var r=Xt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Qt.call(r)==Yt},ee={};ee["[object Float32Array]"]=ee["[object Float64Array]"]=ee["[object Int8Array]"]=ee["[object Int16Array]"]=ee["[object Int32Array]"]=ee["[object Uint8Array]"]=ee["[object Uint8ClampedArray]"]=ee["[object Uint16Array]"]=ee["[object Uint32Array]"]=!0,ee["[object Arguments]"]=ee["[object Array]"]=ee["[object ArrayBuffer]"]=ee["[object Boolean]"]=ee["[object DataView]"]=ee["[object Date]"]=ee["[object Error]"]=ee["[object Function]"]=ee["[object Map]"]=ee["[object Number]"]=ee["[object Object]"]=ee["[object RegExp]"]=ee["[object Set]"]=ee["[object String]"]=ee["[object WeakMap]"]=!1;var re=function(t){return Tt(t)&&Rt(t.length)&&!!ee[C(t)]};var ie=function(t){return function(e){return t(e)}},ne=_((function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r&&j.process,o=function(){try{var t=i&&i.require&&i.require("util").types;return t||n&&n.binding&&n.binding("util")}catch(t){}}();t.exports=o})),oe=ne&&ne.isTypedArray,ae=oe?ie(oe):re;var se=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},ue=Object.prototype.hasOwnProperty;var ce=function(t,e,r){var i=t[e];ue.call(t,e)&&u(i,r)&&(void 0!==r||e in t)||jt(t,e,r)};var le=function(t,e,r,i){var n=!r;r||(r={});for(var o=-1,a=e.length;++o<a;){var s=e[o],u=i?i(r[s],t[s],s,r,t):void 0;void 0===u&&(u=t[s]),n?jt(r,s,u):ce(r,s,u)}return r};var pe=function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i},fe=/^(?:0|[1-9]\d*)$/;var he=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&fe.test(t))&&t>-1&&t%1==0&&t<e},de=Object.prototype.hasOwnProperty;var ye=function(t,e){var r=Ut(t),i=!r&&Ht(t),n=!r&&!i&&Zt(t),o=!r&&!i&&!n&&ae(t),a=r||i||n||o,s=a?pe(t.length,String):[],u=s.length;for(var c in t)!e&&!de.call(t,c)||a&&("length"==c||n&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||he(c,u))||s.push(c);return s};var be=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},ve=Object.prototype.hasOwnProperty;var we=function(t){if(!z(t))return be(t);var e=Ct(t),r=[];for(var i in t)("constructor"!=i||!e&&ve.call(t,i))&&r.push(i);return r};var ge=function(t){return Gt(t)?ye(t,!0):we(t)};var Le=function(t){return le(t,ge(t))};var me=function(t,e,r,i,n,o,a){var s=se(t,r),u=se(e,r),c=a.get(u);if(c)xt(t,r,c);else{var l=o?o(s,u,r+"",t,e,a):void 0,p=void 0===l;if(p){var f=Ut(u),h=!f&&Zt(u),d=!f&&!h&&ae(u);l=u,f||h||d?Ut(s)?l=s:$t(s)?l=kt(s):h?(p=!1,l=Dt(u,!0)):d?(p=!1,l=Pt(u,!0)):l=[]:te(u)||Ht(u)?(l=s,Ht(s)?l=Le(s):z(s)&&!E(s)||(l=zt(u))):p=!1}p&&(a.set(u,l),n(l,u,i,o,a),a.delete(u)),xt(t,r,l)}};var _e=function t(e,r,i,n,o){e!==r&&Ft(r,(function(a,s){if(o||(o=new mt),z(a))me(e,r,s,i,t,n,o);else{var u=n?n(se(e,s),a,s+"",e,r,o):void 0;void 0===u&&(u=a),xt(e,s,u)}}),ge)};var je=function(t){return t};var xe=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},Fe=Math.max;var De=function(t,e,r){return e=Fe(void 0===e?t.length-1:e,0),function(){for(var i=arguments,n=-1,o=Fe(i.length-e,0),a=Array(o);++n<o;)a[n]=i[e+n];n=-1;for(var s=Array(e+1);++n<e;)s[n]=i[n];return s[e]=r(a),xe(t,this,s)}};var Se=function(t){return function(){return t}},Oe=_t?function(t,e){return _t(t,"toString",{configurable:!0,enumerable:!1,value:Se(e),writable:!0})}:je,Pe=Date.now;var ke=function(t){var e=0,r=0;return function(){var i=Pe(),n=16-(i-r);if(r=i,n>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Oe);var Me=function(t,e){return ke(De(t,e,je),t+"")};var Ve=function(t,e,r){if(!z(r))return!1;var i=typeof e;return!!("number"==i?Gt(r)&&he(e,r.length):"string"==i&&e in r)&&u(r[e],t)};var Be,Ae,Ce,ze,Te,Ee=function(t){return Me((function(e,r){var i=-1,n=r.length,o=n>1?r[n-1]:void 0,a=n>2?r[2]:void 0;for(o=t.length>3&&"function"==typeof o?(n--,o):void 0,a&&Ve(r[0],r[1],a)&&(o=n<3?void 0:o,n=1),e=Object(e);++i<n;){var s=r[i];s&&t(e,s,i,o)}return e}))},Ne=Ee((function(t,e,r){_e(t,e,r)})),Ie=_((function(t){var e=Object.prototype.hasOwnProperty,r="~";function i(){}function n(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,i,o,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new n(i,o||t,a),u=r?r+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,i,n=[];if(0===this._eventsCount)return n;for(i in t=this._events)e.call(t,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},s.prototype.listeners=function(t){var e=r?r+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,a=new Array(o);n<o;n++)a[n]=i[n].fn;return a},s.prototype.listenerCount=function(t){var e=r?r+t:t,i=this._events[e];return i?i.fn?1:i.length:0},s.prototype.emit=function(t,e,i,n,o,a){var s=arguments,u=r?r+t:t;if(!this._events[u])return!1;var c,l,p=this._events[u],f=arguments.length;if(p.fn){switch(p.once&&this.removeListener(t,p.fn,void 0,!0),f){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,e),!0;case 3:return p.fn.call(p.context,e,i),!0;case 4:return p.fn.call(p.context,e,i,n),!0;case 5:return p.fn.call(p.context,e,i,n,o),!0;case 6:return p.fn.call(p.context,e,i,n,o,a),!0}for(l=1,c=new Array(f-1);l<f;l++)c[l-1]=s[l];p.fn.apply(p.context,c)}else{var h,d=p.length;for(l=0;l<d;l++)switch(p[l].once&&this.removeListener(t,p[l].fn,void 0,!0),f){case 1:p[l].fn.call(p[l].context);break;case 2:p[l].fn.call(p[l].context,e);break;case 3:p[l].fn.call(p[l].context,e,i);break;case 4:p[l].fn.call(p[l].context,e,i,n);break;default:if(!c)for(h=1,c=new Array(f-1);h<f;h++)c[h-1]=s[h];p[l].fn.apply(p[l].context,c)}}return!0},s.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,i,n){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||n&&!s.once||i&&s.context!==i||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==e||n&&!s[u].once||i&&s[u].context!==i)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&a(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s})).EventEmitter,We={Point:0,MultiPoint:1,LineString:2,MultiLineString:3,Polygon:4,MultiPolygon:5,GeometryCollection:6};function He(t){for(var e=0;e<t.length;e++)Ue(t[e])}function Ue(t){for(var e=0;e<t.length;e++)Re(t[e])}function Re(t){ze=Math.max(ze,t.length);for(var e=0;e<t.length;e++)for(;Math.round(t[e]*Te)/Te!==t[e]&&Te<1e6;)Te*=10}function Ge(t){void 0===Be[t]&&(Ce.push(t),Be[t]=Ae++)}function $e(t,e){for(var r=0;r<t.features.length;r++)e.writeMessage(1,qe,t.features[r]);Je(t,e,!0)}function qe(t,e){null!==t.geometry&&e.writeMessage(1,Ze,t.geometry),void 0!==t.id&&("number"==typeof t.id&&t.id%1==0?e.writeSVarintField(12,t.id):e.writeStringField(11,t.id)),t.properties&&Je(t.properties,e),Je(t,e,!0)}function Ze(t,e){e.writeVarintField(1,We[t.type]);var r=t.coordinates;if("Point"===t.type)!function(t,e){for(var r=[],i=0;i<ze;i++)r.push(Math.round(t[i]*Te));e.writePackedSVarint(3,r)}(r,e);else if("MultiPoint"===t.type)Qe(r,e);else if("LineString"===t.type)Qe(r,e);else if("MultiLineString"===t.type)Xe(r,e);else if("Polygon"===t.type)Xe(r,e,!0);else if("MultiPolygon"===t.type)!function(t,e){var r,i,n=t.length;if(1!==n||1!==t[0].length){var o=[n];for(r=0;r<n;r++)for(o.push(t[r].length),i=0;i<t[r].length;i++)o.push(t[r][i].length-1);e.writePackedVarint(2,o)}var a=[];for(r=0;r<n;r++)for(i=0;i<t[r].length;i++)Ye(a,t[r][i],!0);e.writePackedSVarint(3,a)}(r,e);else if("GeometryCollection"===t.type)for(var i=0;i<t.geometries.length;i++)e.writeMessage(4,Ze,t.geometries[i]);Je(t,e,!0)}function Je(t,e,r){var i=[],n=0;for(var o in t)r&&tr(o,t.type)||(e.writeMessage(13,Ke,t[o]),i.push(Be[o]),i.push(n++));e.writePackedVarint(r?15:14,i)}function Ke(t,e){if(null!==t){var r=typeof t;"string"===r?e.writeStringField(1,t):"boolean"===r?e.writeBooleanField(5,t):"object"===r?e.writeStringField(6,JSON.stringify(t)):"number"===r&&(t%1!=0?e.writeDoubleField(2,t):t>=0?e.writeVarintField(3,t):e.writeVarintField(4,-t))}}function Qe(t,e){var r=[];Ye(r,t),e.writePackedSVarint(3,r)}function Xe(t,e,r){var i,n=t.length;if(1!==n){var o=[];for(i=0;i<n;i++)o.push(t[i].length-(r?1:0));e.writePackedVarint(2,o)}var a=[];for(i=0;i<n;i++)Ye(a,t[i],r);e.writePackedSVarint(3,a)}function Ye(t,e,r){var i,n,o=e.length-(r?1:0),a=new Array(ze);for(n=0;n<ze;n++)a[n]=0;for(i=0;i<o;i++)for(n=0;n<ze;n++){var s=Math.round(e[i][n]*Te)-a[n];t.push(s),a[n]+=s}}function tr(t,e){if("type"===t)return!0;if("FeatureCollection"===e){if("features"===t)return!0}else if("Feature"===e){if("id"===t||"properties"===t||"geometry"===t)return!0}else if("GeometryCollection"===e){if("geometries"===t)return!0}else if("coordinates"===t)return!0;return!1}var er,rr,ir,nr,or,ar=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"];function sr(t,e,r){1===t?er.push(r.readString()):2===t?nr=r.readVarint():3===t?or=Math.pow(10,r.readVarint()):4===t?function(t,e){e.type="FeatureCollection",e.features=[],t.readMessage(lr,e)}(r,e):5===t?ur(r,e):6===t&&cr(r,e)}function ur(t,e){e.type="Feature";var r=t.readMessage(pr,e);return"geometry"in r||(r.geometry=null),r}function cr(t,e){return e.type="Point",t.readMessage(fr,e)}function lr(t,e,r){1===t?e.features.push(ur(r,{})):13===t?rr.push(hr(r)):15===t&&dr(r,e)}function pr(t,e,r){1===t?e.geometry=cr(r,{}):11===t?e.id=r.readString():12===t?e.id=r.readSVarint():13===t?rr.push(hr(r)):14===t?e.properties=dr(r,{}):15===t&&dr(r,e)}function fr(t,e,r){1===t?e.type=ar[r.readVarint()]:2===t?ir=r.readPackedVarint():3===t?function(t,e,r){"Point"===r?t.coordinates=function(t){var e=t.readVarint()+t.pos,r=[];for(;t.pos<e;)r.push(t.readSVarint()/or);return r}(e):"MultiPoint"===r||"LineString"===r?t.coordinates=br(e):"MultiLineString"===r?t.coordinates=vr(e):"Polygon"===r?t.coordinates=vr(e,!0):"MultiPolygon"===r&&(t.coordinates=function(t){var e=t.readVarint()+t.pos;if(!ir)return[[yr(t,e,null,!0)]];for(var r=[],i=1,n=0;n<ir[0];n++){for(var o=[],a=0;a<ir[i];a++)o.push(yr(t,e,ir[i+1+a],!0));i+=ir[i]+1,r.push(o)}return ir=null,r}(e))}(e,r,e.type):4===t?(e.geometries=e.geometries||[],e.geometries.push(cr(r,{}))):13===t?rr.push(hr(r)):15===t&&dr(r,e)}function hr(t){for(var e=t.readVarint()+t.pos,r=null;t.pos<e;){var i=t.readVarint()>>3;1===i?r=t.readString():2===i?r=t.readDouble():3===i?r=t.readVarint():4===i?r=-t.readVarint():5===i?r=t.readBoolean():6===i&&(r=JSON.parse(t.readString()))}return r}function dr(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;)e[er[t.readVarint()]]=rr[t.readVarint()];return rr=[],e}function yr(t,e,r,i){var n,o,a=0,s=[],u=[];for(o=0;o<nr;o++)u[o]=0;for(;r?a<r:t.pos<e;){for(n=[],o=0;o<nr;o++)u[o]+=t.readSVarint(),n[o]=u[o]/or;s.push(n),a++}return i&&s.push(s[0]),s}function br(t){return yr(t,t.readVarint()+t.pos)}function vr(t,e){var r=t.readVarint()+t.pos;if(!ir)return[yr(t,r,null,e)];for(var i=[],n=0;n<ir.length;n++)i.push(yr(t,r,ir[n],e));return ir=null,i}var wr={encode:function(t,e){Be={},Ce=[],Ae=0,ze=0,Te=1,function t(e){var r,i;if("FeatureCollection"===e.type)for(r=0;r<e.features.length;r++)t(e.features[r]);else if("Feature"===e.type)for(i in null!==e.geometry&&t(e.geometry),e.properties)Ge(i);else if("Point"===e.type)Re(e.coordinates);else if("MultiPoint"===e.type)Ue(e.coordinates);else if("GeometryCollection"===e.type)for(r=0;r<e.geometries.length;r++)t(e.geometries[r]);else if("LineString"===e.type)Ue(e.coordinates);else if("Polygon"===e.type||"MultiLineString"===e.type)He(e.coordinates);else if("MultiPolygon"===e.type)for(r=0;r<e.coordinates.length;r++)He(e.coordinates[r]);for(i in e)tr(i,e.type)||Ge(i)}(t),Te=Math.min(Te,1e6);for(var r=Math.ceil(Math.log(Te)/Math.LN10),i=0;i<Ce.length;i++)e.writeStringField(1,Ce[i]);2!==ze&&e.writeVarintField(2,ze);6!==r&&e.writeVarintField(3,r);"FeatureCollection"===t.type?e.writeMessage(4,$e,t):"Feature"===t.type?e.writeMessage(5,qe,t):e.writeMessage(6,Ze,t);return Be=null,e.finish()},decode:function(t){nr=2,or=Math.pow(10,6),ir=null,er=[],rr=[];var e=t.readFields(sr,{});return er=null,e}},gr=Ee((function(t,e,r,i){_e(t,e,r,i)})),Lr=function(t,e,r,i,n){var o,a,s=8*n-i-1,u=(1<<s)-1,c=u>>1,l=-7,p=r?n-1:0,f=r?-1:1,h=t[e+p];for(p+=f,o=h&(1<<-l)-1,h>>=-l,l+=s;l>0;o=256*o+t[e+p],p+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=i;l>0;a=256*a+t[e+p],p+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,i),o-=c}return(h?-1:1)*a*Math.pow(2,o-i)},mr=function(t,e,r,i,n,o){var a,s,u,c=8*o-n-1,l=(1<<c)-1,p=l>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:o-1,d=i?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+p>=1?f/u:f*Math.pow(2,1-p))*u>=2&&(a++,u/=2),a+p>=l?(s=0,a=l):a+p>=1?(s=(e*u-1)*Math.pow(2,n),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,n),a=0));n>=8;t[r+h]=255&s,h+=d,s/=256,n-=8);for(a=a<<n|s,c+=n;c>0;t[r+h]=255&a,h+=d,a/=256,c-=8);t[r+h-d]|=128*y},_r=jr;function jr(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}jr.Varint=0,jr.Fixed64=1,jr.Bytes=2,jr.Fixed32=5;var xr="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Fr(t){return t.type===jr.Bytes?t.readVarint()+t.pos:t.pos+1}function Dr(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Sr(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;n>=t;n--)r.buf[n+i]=r.buf[n]}function Or(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Pr(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function kr(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Mr(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function Vr(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function Br(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function Ar(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function Cr(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function zr(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function Tr(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Er(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function Nr(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}jr.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,o=this.pos;this.type=7&i,t(n,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Tr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Nr(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Tr(this.buf,this.pos)+4294967296*Tr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Tr(this.buf,this.pos)+4294967296*Nr(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Lr(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Lr(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,i=this.buf;return e=127&(r=i[this.pos++]),r<128?e:(e|=(127&(r=i[this.pos++]))<<7,r<128?e:(e|=(127&(r=i[this.pos++]))<<14,r<128?e:(e|=(127&(r=i[this.pos++]))<<21,r<128?e:function(t,e,r){var i,n,o=r.buf;if(n=o[r.pos++],i=(112&n)>>4,n<128)return Dr(t,i,e);if(n=o[r.pos++],i|=(127&n)<<3,n<128)return Dr(t,i,e);if(n=o[r.pos++],i|=(127&n)<<10,n<128)return Dr(t,i,e);if(n=o[r.pos++],i|=(127&n)<<17,n<128)return Dr(t,i,e);if(n=o[r.pos++],i|=(127&n)<<24,n<128)return Dr(t,i,e);if(n=o[r.pos++],i|=(1&n)<<31,n<128)return Dr(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&xr?function(t,e,r){return xr.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){var i="",n=e;for(;n<r;){var o,a,s,u=t[n],c=null,l=u>239?4:u>223?3:u>191?2:1;if(n+l>r)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[n+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[n+1],a=t[n+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[n+1],a=t[n+2],s=t[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),n+=l}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==jr.Bytes)return t.push(this.readVarint(e));var r=Fr(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==jr.Bytes)return t.push(this.readSVarint());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==jr.Bytes)return t.push(this.readBoolean());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==jr.Bytes)return t.push(this.readFloat());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==jr.Bytes)return t.push(this.readDouble());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==jr.Bytes)return t.push(this.readFixed32());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==jr.Bytes)return t.push(this.readSFixed32());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==jr.Bytes)return t.push(this.readFixed64());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==jr.Bytes)return t.push(this.readSFixed64());var e=Fr(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===jr.Varint)for(;this.buf[this.pos++]>127;);else if(e===jr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===jr.Fixed32)this.pos+=4;else{if(e!==jr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Er(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Er(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Er(this.buf,-1&t,this.pos),Er(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Er(this.buf,-1&t,this.pos),Er(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,i;t>=0?(r=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,i=i+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;if(e.buf[e.pos++]|=r|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var i,n,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!n){i>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):n=i;continue}if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(t[r++]=239,t[r++]=191,t[r++]=189,n=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=63&i|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&Sr(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),mr(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),mr(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;i>=128&&Sr(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,jr.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Or,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Pr,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Vr,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,kr,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Mr,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Br,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Ar,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Cr,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,zr,e)},writeBytesField:function(t,e){this.writeTag(t,jr.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,jr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,jr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,jr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,jr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,jr.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,jr.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,jr.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,jr.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,jr.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Ir=function(t,e){this.p1=t,this.p2=e};Ir.prototype.rise=function(){return this.p2[1]-this.p1[1]},Ir.prototype.run=function(){return this.p2[0]-this.p1[0]},Ir.prototype.slope=function(){return this.rise()/this.run()},Ir.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},Ir.prototype.isVertical=function(){return!isFinite(this.slope())},Ir.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},Ir.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},Ir.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},Ir.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),r=this.yIntercept();return Math.abs(e*t[0]-t[1]+r)/Math.sqrt(Math.pow(e,2)+1)},Ir.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)};var Wr=Ir,Hr=function(t,e){for(var r=0,i=0,n=1;n<=t.length-2;n++){var o=new Wr(t[0],t[t.length-1]).perpendicularDistance(t[n]);o>r&&(i=n,r=o)}if(r>e)var a=Hr(t.slice(0,i),e),s=Hr(t.slice(i,t.length),e),u=a.concat(s);else u=t.length>1?[t[0],t[t.length-1]]:[t[0]];return u},Ur=Hr,Rr=_((function(t){function e(e,r){var i=e.geometry,n=i.type;if("LineString"===n)i.coordinates=t.exports.simplify(i.coordinates,r);else if("Polygon"===n||"MultiLineString"===n)for(var o=0;o<i.coordinates.length;o++)i.coordinates[o]=t.exports.simplify(i.coordinates[o],r);else if("MultiPolygon"===n)for(var a=0;a<i.coordinates.length;a++)for(var s=0;s<i.coordinates[a].length;s++)i.coordinates[a][s]=t.exports.simplify(i.coordinates[a][s],r);return e}t.exports=function(t,r,i){return i||(t=JSON.parse(JSON.stringify(t))),t.features?function(t,r){for(var i=0;i<t.features.length;i++)t.features[i]=e(t.features[i],r);return t}(t,r):t.type&&"Feature"===t.type?e(t,r):new Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,e){return Ur(t,e)}})),Gr=(Rr.simplify,2),$r={1:{world:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/35bb8365-1926-471c-b357-db2c02ff3a81.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8ec671c3-a4f9-4fdf-8e88-85d2ab1d8930.bin"},label:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/90c51eb3-04d7-402f-bd05-95e4bd27dd62.bin",parser:{type:"geojson"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"}},country:{CHN:{1:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/380370e0-76aa-4240-8874-5732de77e71d.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/70ec087e-c48a-4b76-8825-6452f17bae7a.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"},label:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/36832a45-68f8-4b51-b006-9dec71f92a23.json"}},2:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/feeb1f06-11c6-4495-84c9-f41ea6f77123.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"}},3:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/24a9ee83-2be1-4fc1-b187-769ac939269d.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},countryLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"},nationalBoundaries2:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/f2189cc4-662b-4358-8573-36f0f918b7ca.json"},island:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/fe49b393-1147-4769-94ed-70471f4ff15d.json"}}},province:{11e4:""}},2:{world:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/ad26cd25-96ea-40fd-935d-7e21a5c08893.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/62f61f5f-cca7-4137-845d-13c8f9969664.bin"},label:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/90c51eb3-04d7-402f-bd05-95e4bd27dd62.bin",parser:{type:"geojson"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"}},country:{CHN:{1:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/25228941-b2ac-4591-b07d-8261ac08d06f.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/70ec087e-c48a-4b76-8825-6452f17bae7a.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/0024caaf-86b2-4e75-a3d1-6d2146490b67.bin"},label:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/36832a45-68f8-4b51-b006-9dec71f92a23.json"}},2:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/522c6496-c711-4581-88db-c3741cd39abd.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/f6a4e2b1-359b-43a6-921c-39d2088d1dab.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/f6a4e2b1-359b-43a6-921c-39d2088d1dab.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/0024caaf-86b2-4e75-a3d1-6d2146490b67.bin"}},3:{fill:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/516b2703-d692-44e6-80dd-b3f5df0186e7.bin"},line:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},countryLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/bc97875a-90f2-42c0-a62c-43d2efd7460d.bin"},cityLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/8bfbfe7e-bd0e-4bbe-84d8-629f4dc7abc4.bin"},provinceLine:{type:"pbf",url:"https://gw.alipayobjects.com/os/bmw-prod/778ad7ba-5a3f-4ed6-a94a-b8ab8acae9d6.bin"}},nationalBoundaries:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/ee493a41-0558-4c0e-bee6-520276c4f1a8.json"},nationalBoundaries2:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/f2189cc4-662b-4358-8573-36f0f918b7ca.json"},island:{type:"json",url:"https://gw.alipayobjects.com/os/bmw-prod/fe49b393-1147-4769-94ed-70471f4ff15d.json"}}},province:{11e4:""}}};function qr(t){return void 0===t&&(t=Gr),$r[t]}function Zr(t){Gr=t}var Jr=$r[Gr];function Kr(t,e){if(Array.isArray(e))return e}var Qr=function(t){function r(e,r){void 0===r&&(r={});var i=t.call(this)||this;return i.layers=[],i.scene=e,i.options=gr(i.getDefaultOption(),r,Kr),Zr(i.options.geoDataLevel),i}return i(r,t),r.prototype.destroy=function(){var t=this;this.layers.forEach((function(e){return t.scene.removeLayer(e)})),this.layers.length=0},r.prototype.show=function(){this.layers.forEach((function(t){return t.show()}))},r.prototype.hide=function(){this.layers.forEach((function(t){return t.hide()}))},r.prototype.setOption=function(t){this.options=gr(this.options,t,Kr)},r.prototype.getFillData=function(){return this.fillData},r.prototype.updateData=function(t,e){this.setOption({data:t,joinBy:e});var r=this.options,i=r.data,n=void 0===i?[]:i,o=r.joinBy;this.fillLayer.setData(this.fillData,{transforms:0===n.length?[]:[{type:"join",sourceField:o[1],targetField:o[0],data:n}]})},r.prototype.fetchData=function(t){return o(this,void 0,void 0,(function(){var e,r,i;return a(this,(function(n){switch(n.label){case 0:return"pbf"!==t.type?[3,3]:[4,fetch(t.url)];case 1:return[4,n.sent().arrayBuffer()];case 2:return e=n.sent(),r=wr.decode(new _r(e)),!1!==this.options.simplifyTolerance&&(r=Rr(r,this.options.simplifyTolerance)),[2,r];case 3:return z(t.url)?(i=t.url,[3,6]):[3,4];case 4:return[4,fetch(t.url)];case 5:i=n.sent().json(),n.label=6;case 6:return[2,i]}}))}))},r.prototype.getDefaultOption=function(){return{zIndex:0,visible:!0,geoDataLevel:2,depth:1,adcode:[],joinBy:["name","name"],simplifyTolerance:!1,label:{enable:!0,color:"#000",field:"name",size:10,stroke:"#fff",strokeWidth:2,textAllowOverlap:!0,opacity:1,textOffset:[0,0],padding:[5,5]},bubble:{enable:!1,shape:"circle",color:"#1AA9FF",size:15,style:{opacity:1,stroke:"#fff",strokeWidth:1}},fill:{scale:null,color:"#ddd",style:{opacity:1},activeColor:!1},autoFit:!0,showBorder:!0,stroke:"#bdbdbd",strokeVisible:!0,strokeWidth:.6,cityStroke:"#636363",cityStrokeWidth:.6,countyStrokeWidth:.6,provinceStrokeWidth:.6,provinceStroke:"#f0f0f0",provinceStrokeVisible:!0,countyStroke:"#525252",coastlineStroke:"#4190da",coastlineWidth:.6,nationalStroke:"#c994c7",nationalWidth:.5,chinaNationalStroke:"gray",chinaNationalWidth:1,popup:{enable:!0,openTriggerEvent:"mousemove",closeTriggerEvent:"mouseout",option:{},Html:function(t){return""+t.name}}}},r.prototype.addFillLayer=function(t){var r,i=this.options,o=i.popup,a=i.data,s=void 0===a?[]:a,u=i.fill,c=i.autoFit,l=i.joinBy,p=i.visible;this.fillData=t;var f=new e.PolygonLayer({autoFit:c,visible:p}).source(t,{transforms:0===s.length?[]:[{type:"join",sourceField:l[1],targetField:l[0],data:s}]});if(this.setLayerAttribute(f,"color",u.color),this.setLayerAttribute(f,"filter",u.filter),u.scale&&z(u.color)&&f.scale("color",{type:u.scale,field:u.color.field}),f.shape("fill").style(u.style),u.activeColor&&f.active({color:u.activeColor}),this.fillLayer=f,this.layers.push(f),this.scene.addLayer(f),this.options.bubble&&!1!==(null===(r=this.options.bubble)||void 0===r?void 0:r.enable)){var h=t.features.map((function(t){return n(n({},t.properties),{center:[t.properties.x,t.properties.y]})}));this.addBubbleLayer(h)}o.enable&&this.addPopup(),this.emit("loaded")},r.prototype.addFillLine=function(t){var r=this.options,i=r.stroke,n=r.strokeWidth,o=r.zIndex,a=r.visible,s=new e.LineLayer({zIndex:o+.1,visible:a}).source(t).color(i).size(n).style({opacity:1});this.scene.addLayer(s),this.layers.push(s),this.lineLayer=s},r.prototype.addLabelLayer=function(t,e){void 0===e&&(e="json");var r=this.addLabel(t,e);this.scene.addLayer(r),this.layers.push(r),this.labelLayer=r},r.prototype.addBubbleLayer=function(t,r){void 0===r&&(r="json");var i=this.options,n=i.bubble,o=i.zIndex,a=i.data,s=void 0===a?[]:a,u=i.joinBy,c=i.visible,l=new e.PointLayer({zIndex:o+.3,visible:c}).source(t,{parser:{type:r,coordinates:"center"},transforms:0===s.length?[]:[{type:"join",sourceField:u[1],targetField:u[0],data:s}]});return this.setLayerAttribute(l,"color",n.color),this.setLayerAttribute(l,"size",n.size),this.setLayerAttribute(l,"shape",n.shape),this.setLayerAttribute(l,"filter",n.filter),n.scale&&l.scale(n.scale.field,{type:n.scale.type}),l.style(n.style),this.scene.addLayer(l),this.layers.push(l),this.bubbleLayer=l,l},r.prototype.addLabel=function(t,r){void 0===r&&(r="json");var i=this.options,n=i.label,o=i.zIndex,a=i.visible,s=new e.PointLayer({zIndex:o+5,visible:a}).source(t,{parser:{type:r,coordinates:"center"}}).shape(n.field,"text").style(n);return this.setLayerAttribute(s,"color",n.color),this.setLayerAttribute(s,"size",n.size),this.setLayerAttribute(s,"filter",n.filter),s},r.prototype.addPopup=function(){var t,r=this,i=this.options.popup;(t=i.triggerLayer?"bubble"===i.triggerLayer?this.bubbleLayer:this.fillLayer:this.options.bubble.enable?this.bubbleLayer:this.fillLayer).on(i.openTriggerEvent,(function(t){var o=i.Html?i.Html(t.feature.properties?t.feature.properties:t.feature):"";r.popup=new e.Popup(n({closeButton:!1},i.option)).setLnglat(t.lngLat).setHTML(o),r.scene.addPopup(r.popup)})),t.on(i.closeTriggerEvent,(function(t){r.popup&&r.popup.remove()}))},r.prototype.setLayerAttribute=function(t,e,r){r&&(z(r)?t[e](r.field,r.values):t[e](r))},r}(Ie),Xr=function(t){function e(e,r){void 0===r&&(r={});var i=t.call(this,e,r)||this;return i.addProvinceFillLayer(),i}return i(e,t),e.prototype.updateDistrict=function(t,e,r){var i;if(t||!Array.isArray(t)||0!==t.length){var o=this.options,a=o.label,s=o.showBorder;this.setOption({adcode:t});var u=this.filterData(this.fillRawData,t),c=this.filterData(this.lineRawData,t),l=this.filterLabelData(this.labelRawData,t);if(this.options.bubble&&!1!==(null===(i=this.options.bubble)||void 0===i?void 0:i.enable)){var p=u.features.map((function(t){return n(n({},t.properties),{center:[t.properties.x,t.properties.y]})}));this.bubbleLayer.setData(p)}this.fillData=u,this.updateData(e,r),s&&this.lineLayer.setData(c),a.enable&&this.labelLayer.setData(l),this.show()}else this.hide()},e.prototype.getDefaultOption=function(){var e=t.prototype.getDefaultOption.call(this);return Ne({},e,{adcode:["110000"],depth:2,label:{field:"NAME_CHN",textAllowOverlap:!1},popup:{enable:!0,Html:function(t){return"<span>"+t.NAME_CHN+"</span>"}}})},e.prototype.filterData=function(t,e){var r=Array.isArray(e)?e:[e];return{type:"FeatureCollection",features:t.features.filter((function(t){var e=t.properties.adcode_pro;return-1!==r.indexOf(e)||-1!==r.indexOf(""+e)}))}},e.prototype.filterLabelData=function(t,e){var r=Array.isArray(e)?e:[e];return t.filter((function(t){var e=t.adcode_pro;return-1!==r.indexOf(e)||-1!==r.indexOf(""+e)}))},e.prototype.addProvinceFillLayer=function(){return o(this,void 0,void 0,(function(){var t,e,r,i,o,s,u,c,l;return a(this,(function(a){switch(a.label){case 0:return t=this.options,e=t.depth,r=t.adcode,i=t.label,o=t.showBorder,s=qr(this.options.geoDataLevel).country.CHN[e],[4,this.fetchData(s.fill)];case 1:return u=a.sent(),this.labelRawData=u.features.map((function(t){return n(n({},t.properties),{center:[t.properties.x,t.properties.y]})})),c=this.filterData(u,r),this.fillData=c,l=this.filterLabelData(this.labelRawData,r),this.fillRawData=u,this.addFillLayer(c),i.enable&&this.addLabelLayer(l),this.lineRawData=u,o&&this.addFillLine(c),[2]}}))}))},e.prototype.addProvinceLineLayer=function(){return o(this,void 0,void 0,(function(){var t,e,r,i,n,o;return a(this,(function(a){switch(a.label){case 0:return t=this.options,e=t.depth,r=t.adcode,i=qr(this.options.geoDataLevel).country.CHN[e],[4,this.fetchData(i.line)];case 1:return n=a.sent(),o=this.filterData(n,r),this.lineRawData=n,this.addFillLine(o),[2]}}))}))},e}(Qr),Yr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getDefaultOption=function(){var e=t.prototype.getDefaultOption.call(this);return Ne({},e,{adcode:["110000"],depth:3})},e.prototype.filterData=function(t,e){var r=Array.isArray(e)?e:[e];return{type:"FeatureCollection",features:t.features.filter((function(t){var e=t.properties.adcode_cit;return-1!==r.indexOf(e)||-1!==r.indexOf(""+e)}))}},e.prototype.filterLabelData=function(t,e){var r=Array.isArray(e)?e:[e];return t.filter((function(t){var e=t.adcode_cit;return-1!==r.indexOf(e)||-1!==r.indexOf(""+e)}))},e}(Xr),ti=function(t){function r(e,r){void 0===r&&(r={});var i=t.call(this,e,r)||this,n=i.options,o=n.depth,a=n.showBorder;i.addProvinceFill(),i.addProvinceLabel();var s=qr(i.options.geoDataLevel).country.CHN[o];return a&&(i.addProvinceLine(s.provinceLine),2===o&&i.addCityBorder(s.fill),3===o&&i.addCountyBorder(s.fill)),i}return i(r,t),r.prototype.addProvinceFill=function(){return o(this,void 0,void 0,(function(){var t,e,r;return a(this,(function(i){switch(i.label){case 0:return t=this.options.depth,e=qr(this.options.geoDataLevel).country.CHN[t],[4,this.fetchData(e.fill)];case 1:return r=i.sent(),this.addFillLayer(r),[2]}}))}))},r.prototype.addProvinceLabel=function(){var t;return o(this,void 0,void 0,(function(){var e,r,i,n;return a(this,(function(o){switch(o.label){case 0:return e=this.options.depth,(r=qr(this.options.geoDataLevel).country.CHN[e]).label?[4,this.fetchData(r.label)]:[3,2];case 1:return n=o.sent(),[3,3];case 2:n=null,o.label=3;case 3:return(i=n)&&(null===(t=this.options.label)||void 0===t?void 0:t.enable)&&(this.addLabelLayer(i.filter((function(t){return"澳门"!==t.name}))),this.addMCLabel()),[2]}}))}))},r.prototype.addProvinceLine=function(t){return o(this,void 0,void 0,(function(){var e,r,i,n,o,s,u;return a(this,(function(a){switch(a.label){case 0:return[4,this.fetchData(t)];case 1:return e=a.sent(),r=e.features.filter((function(t){return"1"===t.properties.type})),i=e.features.filter((function(t){return"4"===t.properties.type})),n={type:"FeatureCollection",features:r},o={type:"FeatureCollection",features:i},s=e.features.filter((function(t){var e=t.properties.type;return"1"!==e&&"4"!==e})),u={type:"FeatureCollection",features:s},this.addNationBorder(u,n,o),[2]}}))}))},r.prototype.loadData=function(){return o(this,void 0,void 0,(function(){var t,e,r,i;return a(this,(function(n){switch(n.label){case 0:return t=this.options.depth,e=qr(this.options.geoDataLevel).country.CHN[t],[4,this.fetchData(e.fill)];case 1:return r=n.sent(),e.label?[4,this.fetchData(e.label)]:[3,3];case 2:return i=n.sent(),[3,4];case 3:i=null,n.label=4;case 4:return[2,[r,i]]}}))}))},r.prototype.addNationBorder=function(t,r,i){return o(this,void 0,void 0,(function(){var n,o,s,u,c,l,p,f,h,d,y,b,v;return a(this,(function(a){return n=this.options,n.nationalStroke,o=n.provinceStroke,s=n.provinceStrokeWidth,n.nationalWidth,u=n.chinaNationalStroke,c=n.chinaNationalWidth,l=n.coastlineStroke,p=n.coastlineWidth,f=n.showBorder,n.stroke,n.strokeWidth,h=n.visible,d=n.zIndex,y=new e.LineLayer({zIndex:d+.1,visible:h&&f}).source(t).size("type",(function(t){return"3"===t?s:"2"===t?p:"0"===t?c:"#fff"})).shape("line").color("type",(function(t){return"3"===t?o:"2"===t?l:"0"===t?u:"#fff"})),b=new e.LineLayer({zIndex:d+.1,visible:h&&f}).source(r).size(c).shape("line").color(u).style({lineType:"dash",dashArray:[2,2]}),v=new e.LineLayer({zIndex:d+.1,visible:h&&f}).source(i).size(s).shape("line").color(o).style({lineType:"dash",dashArray:[4,2,2,2]}),this.scene.addLayer(y),this.scene.addLayer(b),this.scene.addLayer(v),this.layers.push(y,b,v),[2]}))}))},r.prototype.addCityBorder=function(t){return o(this,void 0,void 0,(function(){var r,i,n,o,s,u;return a(this,(function(a){switch(a.label){case 0:return[4,this.fetchData(t)];case 1:return r=a.sent(),i=this.options,n=i.cityStroke,o=i.cityStrokeWidth,s=i.visible,u=new e.LineLayer({zIndex:2,visible:s}).source(r).color(n).size(o).style({opacity:.5}),this.scene.addLayer(u),this.layers.push(u),[2]}}))}))},r.prototype.addCountyBorder=function(t){return o(this,void 0,void 0,(function(){var r,i,n,o,s,u;return a(this,(function(a){switch(a.label){case 0:return[4,this.fetchData(t)];case 1:return r=a.sent(),i=this.options,n=i.countyStrokeWidth,o=i.countyStroke,s=i.visible,u=new e.LineLayer({zIndex:2,visible:s}).source(r).color(o).size(n).style({opacity:.5}),this.scene.addLayer(u),this.layers.push(u),[2]}}))}))},r.prototype.addMCLabel=function(){var t=[{name:"澳门",center:[113.537747,22.187009]}],e=this.addText(t,{maxZoom:2.9},[-45,-10]),r=this.addText(t,{minZoom:3,maxZoom:4},[-35,-10]),i=this.addText(t,{minZoom:4.1},[0,0]);this.scene.addLayer(i),this.scene.addLayer(e),this.scene.addLayer(r),this.layers.push(i,e,r)},r.prototype.addText=function(t,r,i){var o=this.options,a=o.label,s=o.zIndex,u=o.visible;return new e.PointLayer(n({zIndex:s+.4,visible:u},r)).source(t,{parser:{type:"json",coordinates:"center"}}).color(a.color).shape("name","text").size(a.size).style({opacity:a.opacity,stroke:a.stroke,strokeWidth:a.strokeWidth,textAllowOverlap:a.textAllowOverlap,textOffset:i})},r}(Qr),ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getDefaultOption=function(){var e=t.prototype.getDefaultOption.call(this);return Ne({},e,{adcode:["110100"],depth:3})},e.prototype.filterData=function(t,e){var r=Array.isArray(e)?e:[e];return{type:"FeatureCollection",features:t.features.filter((function(t){var e=t.properties.adcode;return-1!==r.indexOf(e)||-1!==r.indexOf(""+e)}))}},e.prototype.filterLabelData=function(t,e){var r=Array.isArray(e)?e:[e];return t.filter((function(t){var e=t.adcode;return-1!==r.indexOf(e)||-1!==r.indexOf(""+e)}))},e}(Xr);function ri(t,e){if(Array.isArray(e))return e}var ii=function(){function t(t,e){var r=this;this.drillState=0,this.layers=[],this.options=gr(this.getDefaultOption(),e,ri),this.scene=t,this.provinceLayer=new ti(t,this.getLayerOption("province")),this.cityLayer=new Xr(t,this.getLayerOption("city")),this.countyLayer=new Yr(t,this.getLayerOption("county")),this.scene.setMapStatus({doubleClickZoom:!1}),this.options.customTrigger||(this.provinceLayer.on("loaded",(function(){r.addCountryEvent(),r.layers.push(r.provinceLayer)})),this.cityLayer.on("loaded",(function(){r.addProvinceEvent(),r.layers.push(r.cityLayer)})),this.countyLayer.on("loaded",(function(){r.addCityEvent(),r.layers.push(r.cityLayer)})))}return t.prototype.getDefaultOption=function(){return{drillDepth:2,customTrigger:!1,drillDownTriggerEvent:"click",drillUpTriggerEvent:"undblclick",provinceData:[],cityData:[],countyData:[],city:{adcode:[]},county:{adcode:[]}}},t.prototype.addCountryEvent=function(){var t=this,e=this.options.drillDownTriggerEvent;this.provinceLayer.fillLayer.on(e,(function(e){t.provinceLayer.hide(),t.drillDown(e.feature.properties.adcode)}))},t.prototype.addProvinceEvent=function(){var t=this,e=this.options,r=e.drillDownTriggerEvent,i=e.drillUpTriggerEvent;this.cityLayer.fillLayer.on(i,(function(){t.drillUp()})),this.cityLayer.fillLayer.on(r,(function(e){t.drillDown(e.feature.properties.adcode)}))},t.prototype.addCityEvent=function(){var t=this,e=this.options,r=(e.drillDownTriggerEvent,e.drillUpTriggerEvent);this.countyLayer.fillLayer.on(r,(function(){t.drillUp()}))},t.prototype.show=function(){this.layers.forEach((function(t){return t.show()}))},t.prototype.hide=function(){this.layers.forEach((function(t){return t.hide()}))},t.prototype.destroy=function(){this.layers.forEach((function(t){return t.destroy()}))},t.prototype.showProvinceView=function(t,e,r){this.cityLayer.show(),this.cityLayer.updateDistrict(t,e,r),this.cityLayer.fillLayer.fitBounds(),this.countyLayer.hide(),this.drillState=1},t.prototype.showCityView=function(t,e,r){this.countyLayer.show();var i=""+t;"00"===i.substr(2,2)&&(i=i.substr(0,2)+"0100"),this.countyLayer.updateDistrict(i,e,r),this.countyLayer.fillLayer.fitBounds(),this.cityLayer.hide(),this.drillState=2},t.prototype.drillUp=function(){switch(this.drillState){case 2:this.cityLayer.show(),this.cityLayer.fillLayer.fitBounds(),this.countyLayer.hide(),this.drillState=1;break;case 1:this.provinceLayer.show(),this.provinceLayer.fillLayer.fitBounds(),this.cityLayer.hide(),this.drillState=0}},t.prototype.drillDown=function(t,e,r){var i=this.options.drillDepth;if(this.drillState!==i)switch(this.drillState){case 0:this.showProvinceView(t,e,r);break;case 1:this.showCityView(t,e,r)}},t.prototype.updateData=function(t,e,r){switch(t){case"province":this.provinceLayer.updateData(e,r);break;case"city":this.cityLayer.updateData(e,r);break;case"county":this.countyLayer.updateData(e,r)}},t.prototype.getLayerOption=function(t){var e=this.options,r=e.joinBy,i=e.label,o=e.bubble,a=e.fill,s=e.popup,u=e.geoDataLevel,c=t+"Data";return n({data:this.options[c],joinBy:r,label:i,bubble:o,fill:a,popup:s,geoDataLevel:u},this.options[t])},t}(),ni=function(t){function r(e,r){void 0===r&&(r={});var i=t.call(this,e,r)||this;return i.loadData().then((function(t){var e,r=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}(t,3),n=r[0],o=r[1],a=r[2];i.addFillLayer(n),i.options.showBorder&&i.addFillLine(o),(null===(e=i.options.label)||void 0===e?void 0:e.enable)&&i.addLabelLayer(a,"json")})),i}return i(r,t),r.prototype.addFillLine=function(t){var e={type:"FeatureCollection",features:t.features.filter((function(t){return"10"===t.properties.type||"1"===t.properties.type||"11"===t.properties.type||"8"===t.properties.type}))},r={type:"FeatureCollection",features:t.features.filter((function(t){return"10"!==t.properties.type&&"1"!==t.properties.type&&"11"!==t.properties.type&&"8"!==t.properties.type}))};this.addNationBorder(r,e)},r.prototype.loadData=function(){return o(this,void 0,void 0,(function(){var t,e,r,i;return a(this,(function(o){switch(o.label){case 0:return t=qr(this.options.geoDataLevel).world,[4,this.fetchData(t.fill)];case 1:return e=o.sent(),[4,this.fetchData(t.line)];case 2:return r=o.sent(),i=e.features.map((function(t){return n(n({},t.properties),{center:[t.properties.x,t.properties.y]})})),[2,[e,r,i]]}}))}))},r.prototype.addNationBorder=function(t,r){var i=this.options,n=i.nationalStroke,o=i.nationalWidth,a=i.coastlineStroke,s=i.chinaNationalStroke,u=i.chinaNationalWidth,c=i.coastlineWidth,l=i.visible,p=i.zIndex,f=new e.LineLayer({zIndex:p+.1,visible:l}).source(t).size("type",(function(t){return"0"===t?u:"2"===t||"9"===t?c:o})).color("type",(function(t){return"0"===t?s:"2"===t||"9"===t?a:n})),h=new e.LineLayer({zIndex:p+.1,visible:l}).source(r).size("type",(function(t){return"1"===t?u:o})).shape("line").color("type",(function(t){return"1"===t?s:n})).style({lineType:"dash",dashArray:[2,2]});this.scene.addLayer(f),this.scene.addLayer(h),this.layers.push(f,h)},r}(Qr);t.CityLayer=Yr,t.CountryLayer=ti,t.CountyLayer=ei,t.DataConfig=Jr,t.DrillDownLayer=ii,t.ProvinceLayer=Xr,t.WorldLayer=ni,t.getDataConfig=qr,t.setDataConfig=function(t,e){void 0===e&&(e=Gr),Ne($r[e],t)},t.setDataLevel=Zr,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=l7-district.js.map
