{"version":3,"sources":["../src/marker.ts"],"names":["Marker","option","markerOption","defaultMarker","popup","mapsService","lngLat","scene","added","eventHandle","e","emit","type","target","data","extData","getDefault","init","element","undefined","anchor","anchorType","BOTTOM","offsets","color","draggable","get","TYPES","IMapService","getMarkerContainer","appendChild","registerMarkerEvent","on","update","off","onMapClick","addDragHandler","onUp","unRegisterMarkerEvent","removeAllListeners","DOM","remove","Array","isArray","lng","lat","setLnglat","el","once","setElement","openPopup","isOpen","addTo","closePopup","Error","updatePosition","setTransform","anchorTranslate","togglePopup","bounds","getBounds","zoom","getZoom","style","display","pos","lngLatToContainer","left","x","top","y","create","svg","document","createElementNS","setAttributeNS","path","addClass","addEventListener","getElement","removeEventListener","EventEmitter"],"mappings":"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","sourcesContent":["import {\n  ILngLat,\n  IMapService,\n  IMarkerOption,\n  IPoint,\n  IPopup,\n  TYPES,\n} from '@antv/l7-core';\nimport {\n  anchorTranslate,\n  anchorType,\n  applyAnchorClass,\n  bindAll,\n  DOM,\n} from '@antv/l7-utils';\nimport { EventEmitter } from 'eventemitter3';\nimport { Container } from 'inversify';\n\n//  marker 支持 dragger 未完成\nexport default class Marker extends EventEmitter {\n  private markerOption: IMarkerOption;\n  private defaultMarker: boolean;\n  private popup: IPopup;\n  private mapsService: IMapService<unknown>;\n  private lngLat: ILngLat;\n  private scene: Container;\n  private added: boolean = false;\n  constructor(option?: Partial<IMarkerOption>) {\n    super();\n    this.markerOption = {\n      ...this.getDefault(),\n      ...option,\n    };\n    bindAll(['update', 'onMove', 'onUp', 'addDragHandler', 'onMapClick'], this);\n    this.init();\n  }\n\n  public getDefault() {\n    return {\n      element: undefined, // DOM element\n      anchor: anchorType.BOTTOM,\n      offsets: [0, 0],\n      color: '#5B8FF9',\n      draggable: false,\n    };\n  }\n\n  public addTo(scene: Container) {\n    // this.remove();\n    this.scene = scene;\n    this.mapsService = scene.get<IMapService>(TYPES.IMapService);\n    const { element, draggable } = this.markerOption;\n    this.mapsService.getMarkerContainer().appendChild(element as HTMLElement);\n    this.registerMarkerEvent(element as HTMLElement);\n    this.mapsService.on('camerachange', this.update);\n    this.update();\n    this.added = true;\n    this.emit('added');\n    return this;\n  }\n\n  public remove() {\n    if (this.mapsService) {\n      this.mapsService.off('click', this.onMapClick);\n      this.mapsService.off('move', this.update);\n      this.mapsService.off('moveend', this.update);\n      this.mapsService.off('mousedown', this.addDragHandler);\n      this.mapsService.off('touchstart', this.addDragHandler);\n      this.mapsService.off('mouseup', this.onUp);\n      this.mapsService.off('touchend', this.onUp);\n    }\n    this.unRegisterMarkerEvent();\n    this.removeAllListeners();\n    const { element } = this.markerOption;\n    if (element) {\n      DOM.remove(element);\n    }\n    if (this.popup) {\n      this.popup.remove();\n    }\n    return this;\n  }\n\n  public setLnglat(lngLat: ILngLat | IPoint) {\n    this.lngLat = lngLat as ILngLat;\n    if (Array.isArray(lngLat)) {\n      this.lngLat = {\n        lng: lngLat[0],\n        lat: lngLat[1],\n      };\n    }\n\n    if (this.popup) {\n      this.popup.setLnglat(this.lngLat);\n    }\n    this.update();\n    return this;\n  }\n\n  public getLnglat(): ILngLat {\n    return this.lngLat;\n  }\n\n  public getElement(): HTMLElement {\n    return this.markerOption.element as HTMLElement;\n  }\n\n  public setElement(el: HTMLElement): this {\n    if (!this.added) {\n      this.once('added', () => {\n        this.setElement(el);\n      });\n      return this;\n    }\n    const { element } = this.markerOption;\n    if (element) {\n      DOM.remove(element);\n    }\n    this.markerOption.element = el;\n    this.init();\n    this.mapsService.getMarkerContainer().appendChild(el as HTMLElement);\n    this.registerMarkerEvent(el as HTMLElement);\n    this.update();\n    return this;\n  }\n\n  public openPopup(): this {\n    if (!this.added) {\n      this.once('added', () => {\n        this.openPopup();\n      });\n      return this;\n    }\n    const popup = this.popup;\n    if (!popup) {\n      return this;\n    }\n    if (!popup.isOpen()) {\n      popup.addTo(this.scene);\n    }\n    return this;\n  }\n\n  public closePopup(): this {\n    if (!this.added) {\n      this.once('added', () => {\n        this.closePopup();\n      });\n    }\n    const popup = this.popup;\n    if (popup) {\n      popup.remove();\n    }\n    return this;\n  }\n\n  public setPopup(popup: IPopup) {\n    this.popup = popup;\n    if (this.lngLat) {\n      this.popup.setLnglat(this.lngLat);\n    }\n    return this;\n  }\n\n  public togglePopup() {\n    const popup = this.popup;\n    if (!popup) {\n      return this;\n    } else if (popup.isOpen()) {\n      popup.remove();\n    } else {\n      popup.addTo(this.scene);\n    }\n    return this;\n  }\n\n  public getPopup() {\n    return this.popup;\n  }\n\n  public getOffset(): number[] {\n    return this.markerOption.offsets;\n  }\n\n  public setDraggable(draggable: boolean) {\n    throw new Error('Method not implemented.');\n  }\n\n  public isDraggable() {\n    return this.markerOption.draggable;\n  }\n\n  public getExtData() {\n    return this.markerOption.extData;\n  }\n\n  public setExtData(data: any) {\n    this.markerOption.extData = data;\n  }\n\n  private update() {\n    if (!this.mapsService) {\n      return;\n    }\n    const { element, anchor } = this.markerOption;\n    this.updatePosition();\n    DOM.setTransform(element as HTMLElement, `${anchorTranslate[anchor]}`);\n  }\n\n  private onMapClick(e: MouseEvent) {\n    const { element } = this.markerOption;\n    if (this.popup && element) {\n      this.togglePopup();\n    }\n  }\n\n  private updatePosition() {\n    if (!this.mapsService) {\n      return;\n    }\n    const { element, offsets } = this.markerOption;\n    const { lng, lat } = this.lngLat;\n    const bounds = this.mapsService.getBounds();\n    const zoom = this.mapsService.getZoom();\n    if (\n      (lng < bounds[0][0] ||\n        lng > bounds[1][0] ||\n        lat < bounds[0][1] ||\n        lat > bounds[1][1]) &&\n      zoom > 3\n    ) {\n      if (element) {\n        element.style.display = 'none';\n      }\n\n      return;\n    }\n    const pos = this.mapsService.lngLatToContainer([lng, lat]);\n    if (element) {\n      element.style.display = 'block';\n      element.style.left = pos.x + offsets[0] + 'px';\n      element.style.top = pos.y - offsets[1] + 'px';\n    }\n  }\n\n  private init() {\n    let { element } = this.markerOption;\n    const { color, anchor } = this.markerOption;\n    if (!element) {\n      this.defaultMarker = true;\n      element = DOM.create('div');\n      this.markerOption.element = element;\n      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      svg.setAttributeNS(null, 'display', 'block');\n      svg.setAttributeNS(null, 'height', '48px');\n      svg.setAttributeNS(null, 'width', '48px');\n      svg.setAttributeNS(null, 'viewBox', '0 0 1024 1024');\n\n      const path = document.createElementNS(\n        'http://www.w3.org/2000/svg',\n        'path',\n      );\n      path.setAttributeNS(\n        null,\n        'd',\n        'M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z',\n      );\n      path.setAttributeNS(null, 'fill', color);\n      svg.appendChild(path);\n      element.appendChild(svg);\n    }\n    DOM.addClass(element, 'l7-marker');\n    element.addEventListener('click', (e: MouseEvent) => {\n      this.onMapClick(e);\n    });\n    element.addEventListener('click', this.eventHandle);\n    applyAnchorClass(element, anchor, 'marker');\n  }\n  private registerMarkerEvent(element: HTMLElement) {\n    element.addEventListener('mousemove', this.eventHandle);\n    element.addEventListener('click', this.eventHandle);\n    element.addEventListener('mousedown', this.eventHandle);\n    element.addEventListener('mouseup', this.eventHandle);\n    element.addEventListener('dblclick', this.eventHandle);\n    element.addEventListener('contextmenu', this.eventHandle);\n    element.addEventListener('mouseover', this.eventHandle);\n    element.addEventListener('mouseout', this.eventHandle);\n  }\n  private unRegisterMarkerEvent() {\n    const element = this.getElement();\n    element.removeEventListener('mousemove', this.eventHandle);\n    element.removeEventListener('click', this.eventHandle);\n    element.removeEventListener('mousedown', this.eventHandle);\n    element.removeEventListener('mouseup', this.eventHandle);\n    element.removeEventListener('dblclick', this.eventHandle);\n    element.removeEventListener('contextmenu', this.eventHandle);\n    element.removeEventListener('mouseover', this.eventHandle);\n    element.removeEventListener('mouseout', this.eventHandle);\n  }\n\n  private eventHandle = (e: MouseEvent) => {\n    this.emit(e.type, {\n      target: e,\n      data: this.markerOption.extData,\n      lngLat: this.lngLat,\n    });\n  };\n  private addDragHandler(e: MouseEvent) {\n    throw new Error('Method not implemented.');\n  }\n\n  private onUp(e: MouseEvent) {\n    throw new Error('Method not implemented.');\n  }\n}\n"],"file":"marker.js"}